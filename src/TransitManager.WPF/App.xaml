<Application x:Class="TransitManager.WPF.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:converters="clr-namespace:TransitManager.WPF.Converters"> <!-- Ligne ajoutée pour reconnaître vos convertisseurs -->
    
    <Application.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<!-- MahApps.Metro -->
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Themes/Light.Blue.xaml" />
				
				<!-- Material Design -->
				<materialDesign:BundledTheme BaseTheme="Light" PrimaryColor="Blue" SecondaryColor="Teal" />
				<ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml" />
				
				<!-- Material Design pour MahApps -->
				<ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.MahApps;component/Themes/MaterialDesignTheme.MahApps.Defaults.xaml" />
				
				<!-- === On neutralise les styles personnalisés TEMPORAIREMENT === -->
				<!-- 
				<ResourceDictionary Source="/Resources/Styles/Colors.xaml" />
				<ResourceDictionary Source="/Resources/Styles/Buttons.xaml" />
				<ResourceDictionary Source="/Resources/Styles/DataGrids.xaml" />
				-->
			</ResourceDictionary.MergedDictionaries>

            <!-- ******* SECTION CORRIGÉE ET AJOUTÉE ******* -->
            <!-- Déclaration globale des convertisseurs pour qu'ils soient trouvés partout -->
            <converters:StatusToColorConverter x:Key="StatusToColorConverter" />
            <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <!-- ******* FIN DE LA SECTION CORRIGÉE ******* -->
            
            <!-- Couleurs de l'application -->
            <Color x:Key="PrimaryColor">#1976D2</Color>
            <Color x:Key="PrimaryLightColor">#63A4FF</Color>
            <Color x:Key="PrimaryDarkColor">#004BA0</Color>
            <Color x:Key="AccentColor">#00897B</Color>
            <Color x:Key="SuccessColor">#4CAF50</Color>
            <Color x:Key="WarningColor">#FF9800</Color>
            <Color x:Key="ErrorColor">#F44336</Color>
            <Color x:Key="InfoColor">#2196F3</Color>
            
            <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource PrimaryColor}" />
            <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource AccentColor}" />
            <SolidColorBrush x:Key="SuccessBrush" Color="{StaticResource SuccessColor}" />
            <SolidColorBrush x:Key="WarningBrush" Color="{StaticResource WarningColor}" />
            <SolidColorBrush x:Key="ErrorBrush" Color="{StaticResource ErrorColor}" />
            <SolidColorBrush x:Key="InfoBrush" Color="{StaticResource InfoColor}" />
            
            <!-- Styles globaux -->
            <Style TargetType="Window">
                <Setter Property="FontFamily" Value="Segoe UI" />
                <Setter Property="FontSize" Value="14" />
            </Style>
            
            <!-- Template pour les notifications Toast -->
            <DataTemplate x:Key="ToastTemplate">
                <Border Background="{DynamicResource MaterialDesignPaper}" 
                        BorderBrush="{DynamicResource PrimaryBrush}" 
                        BorderThickness="1" 
                        CornerRadius="4" 
                        Margin="5">
                    <Grid Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        
                        <materialDesign:PackIcon Grid.Column="0" 
                                               Kind="{Binding IconKind}" 
                                               Width="24" 
                                               Height="24" 
                                               VerticalAlignment="Center" 
                                               Margin="0,0,10,0" />
                        
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="{Binding Title}" 
                                     FontWeight="Bold" 
                                     TextWrapping="Wrap" />
                            <TextBlock Text="{Binding Message}" 
                                     TextWrapping="Wrap" 
                                     Opacity="0.8" />
                        </StackPanel>
                        
                        <Button Grid.Column="2" 
                              Style="{StaticResource MaterialDesignFlatButton}" 
                              Command="{Binding CloseCommand}" 
                              VerticalAlignment="Top">
                            <materialDesign:PackIcon Kind="Close" />
                        </Button>
                    </Grid>
                </Border>
            </DataTemplate>
        </ResourceDictionary>
    </Application.Resources>
</Application>