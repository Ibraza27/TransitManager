<mah:MetroWindow x:Class="TransitManager.WPF.MainWindow"
                  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                  xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                  xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                  mc:Ignorable="d"
                  Title="Transit Manager - Système de Gestion"
                  TitleCharacterCasing="Normal"
                  WindowStartupLocation="CenterScreen"
                  WindowState="Maximized"
                  Height="800" Width="1400"
                  GlowBrush="{DynamicResource AccentBrush}"
                  BorderThickness="1"
                  ResizeMode="CanResize"
                  SaveWindowPosition="True"
                  WindowTransitionsEnabled="False">

    <mah:MetroWindow.RightWindowCommands>
        <mah:WindowCommands>
            <!-- Notifications -->
            <Button x:Name="NotificationButton" 
                    ToolTip="Notifications">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Bell" />
                    <Border x:Name="NotificationBadge"
                            Background="{DynamicResource ErrorBrush}"
                            CornerRadius="10"
                            Margin="-10,-10,0,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Visibility="Collapsed">
                        <TextBlock Text="5" 
                                 Foreground="White" 
                                 FontSize="10"
                                 Margin="5,2"/>
                    </Border>
                </StackPanel>
            </Button>
            
            <!-- Utilisateur connecté -->
            <Button x:Name="UserButton">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Account" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding CurrentUser.NomComplet}" 
                             VerticalAlignment="Center"/>
                </StackPanel>
                <Button.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Mon Profil" Command="{Binding ShowProfileCommand}">
                            <MenuItem.Icon>
                                <materialDesign:PackIcon Kind="AccountCircle"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Paramètres" Command="{Binding ShowSettingsCommand}">
                            <MenuItem.Icon>
                                <materialDesign:PackIcon Kind="Settings"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="Déconnexion" Command="{Binding LogoutCommand}">
                            <MenuItem.Icon>
                                <materialDesign:PackIcon Kind="Logout"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </ContextMenu>
                </Button.ContextMenu>
            </Button>
        </mah:WindowCommands>
    </mah:MetroWindow.RightWindowCommands>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Menu latéral -->
        <Border Grid.Column="0" 
                Background="{DynamicResource MaterialDesignPaper}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,0,1,0">
            <Grid x:Name="SideMenu" Width="250">
                
                <!-- ****** CODE DES ANIMATIONS RAJOUTÉ ICI ****** -->
                <Grid.Resources>
                    <Storyboard x:Key="MenuOpenAnimation">
                        <DoubleAnimation Storyboard.TargetProperty="Width" 
                                       From="60" To="250" 
                                       Duration="0:0:0.3">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseOut"/>
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                    </Storyboard>
                    <Storyboard x:Key="MenuCloseAnimation">
                        <DoubleAnimation Storyboard.TargetProperty="Width" 
                                       From="250" To="60" 
                                       Duration="0:0:0.3">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseIn"/>
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                    </Storyboard>
                </Grid.Resources>
                <!-- ****** FIN DU CODE RAJOUTÉ ****** -->
                
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Le reste du code est identique et correct -->

                <!-- En-tête du menu -->
                <Border Grid.Row="0" 
                        Background="{DynamicResource PrimaryHueDarkBrush}"
                        Padding="20">
                    <StackPanel>
                        <Image Source="/Resources/Images/logo.png" 
                               Height="60" 
                               Margin="0,0,0,10"/>
                        <TextBlock Text="TRANSIT MANAGER" 
                                 Foreground="White"
                                 FontSize="18"
                                 FontWeight="Bold"
                                 HorizontalAlignment="Center"/>
                        <TextBlock Text="Système de Gestion" 
                                 Foreground="White"
                                 FontSize="12"
                                 Opacity="0.8"
                                 HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Items du menu -->
                <ScrollViewer Grid.Row="1" 
                            VerticalScrollBarVisibility="Auto"
                            HorizontalScrollBarVisibility="Disabled">
                    <StackPanel Margin="0,10">
                        <!-- Tableau de bord -->
                        <RadioButton x:Name="DashboardMenu"
                                   Style="{StaticResource MaterialDesignTabRadioButton}"
                                   IsChecked="True"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Dashboard">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ViewDashboard" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Tableau de bord" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- ... (les autres RadioButton restent inchangés) ... -->
						
						<!-- Clients -->
                        <RadioButton Style="{StaticResource MaterialDesignTabRadioButton}"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Clients">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="AccountGroup" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Clients" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- Marchandises/Colis -->
                        <RadioButton Style="{StaticResource MaterialDesignTabRadioButton}"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Colis">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Package" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Marchandises" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- Scan -->
                        <RadioButton Style="{StaticResource MaterialDesignTabRadioButton}"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Scan">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Barcode" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Scanner" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- Conteneurs -->
                        <RadioButton Style="{StaticResource MaterialDesignTabRadioButton}"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Conteneurs">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="TruckDelivery" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Conteneurs" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>

                        <Separator Margin="10,10"/>

                        <!-- Finance -->
                        <RadioButton Style="{StaticResource MaterialDesignTabRadioButton}"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Finance">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="CurrencyEur" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Finance" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- Rapports -->
                        <RadioButton Style="{StaticResource MaterialDesignTabRadioButton}"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Rapports">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ChartBox" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Rapports" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>

                        <Separator Margin="10,10"/>

                        <!-- Administration -->
                        <RadioButton Style="{StaticResource MaterialDesignTabRadioButton}"
                                   Command="{Binding NavigateCommand}"
                                   CommandParameter="Administration"
                                   Visibility="{Binding IsAdmin, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Security" 
                                                       Width="24" Height="24"
                                                       Margin="20,0,20,0"/>
                                <TextBlock Text="Administration" 
                                         VerticalAlignment="Center"
                                         FontSize="14"/>
                            </StackPanel>
                        </RadioButton>
						
                    </StackPanel>
                </ScrollViewer>

                <!-- Pied du menu -->
                <Border Grid.Row="2" 
                        Background="{DynamicResource MaterialDesignToolBarBackground}"
                        Padding="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Bouton réduire/agrandir -->
                        <Button Grid.Row="0"
                                x:Name="ToggleMenuButton"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalAlignment="Center"
                                Click="ToggleMenuButton_Click">
                            <materialDesign:PackIcon Kind="MenuOpen" />
                        </Button>
                        
                        <!-- Version -->
                        <TextBlock Grid.Row="1"
                                 Text="Version 1.0.0"
                                 FontSize="10"
                                 Opacity="0.6"
                                 HorizontalAlignment="Center"
                                 Margin="0,5,0,0"/>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- Zone de contenu principal -->
        <Grid Grid.Column="1">
            <!-- ... (tout le reste est identique et correct) ... -->
        </Grid>
    </Grid>
</mah:MetroWindow>