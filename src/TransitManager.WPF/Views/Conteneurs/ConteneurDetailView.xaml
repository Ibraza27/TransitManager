<UserControl x:Class="TransitManager.WPF.Views.Conteneurs.ConteneurDetailView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
			 xmlns:converters="clr-namespace:TransitManager.WPF.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200">
			 
    <!-- AJOUTER CETTE SECTION DE RESSOURCES -->
    <UserControl.Resources>
        <converters:ToUpperConverter x:Key="ToUpperConverter" />
    </UserControl.Resources>
			 
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

		<!-- En-tête -->
		<materialDesign:Card Grid.Row="0" Padding="20" Margin="10">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="Auto"/>
				</Grid.ColumnDefinitions>

				<StackPanel Grid.Column="0">
					<TextBlock Text="{Binding Title}" Style="{StaticResource MaterialDesignHeadline5TextBlock}"/>
					<TextBlock Text="{Binding Conteneur.NumeroDossier}" Opacity="0.6" Style="{StaticResource MaterialDesignSubtitle1TextBlock}"/>
				</StackPanel>

				<!-- NOUVELLE SECTION : STATISTIQUES GLOBALES -->
				<Border Grid.Column="1" BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="1" CornerRadius="4" Padding="10" Margin="20,0">
					<WrapPanel HorizontalAlignment="Center" VerticalAlignment="Center">
						<StackPanel Orientation="Horizontal" Margin="10,0">
							<materialDesign:PackIcon Kind="CashMultiple" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{DynamicResource PrimaryHueMidBrush}"/>
							<TextBlock Text="Prix Total : "/>
							<TextBlock Text="{Binding PrixTotalGlobal, StringFormat=C}" FontWeight="Bold"/>
						</StackPanel>
						<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
						<StackPanel Orientation="Horizontal" Margin="10,0">
							<materialDesign:PackIcon Kind="CashCheck" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{StaticResource SuccessBrush}"/>
							<TextBlock Text="Total Payé : "/>
							<TextBlock Text="{Binding TotalPayeGlobal, StringFormat=C}" FontWeight="Bold"/>
						</StackPanel>
						<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
						<StackPanel Orientation="Horizontal" Margin="10,0">
							<materialDesign:PackIcon Kind="CashRemove" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{StaticResource ErrorBrush}"/>
							<TextBlock Text="Total Restant : "/>
							<TextBlock Text="{Binding TotalRestantGlobal, StringFormat=C}" FontWeight="Bold"/>
						</StackPanel>
					</WrapPanel>
				</Border>
				<!-- FIN DE LA NOUVELLE SECTION -->
				
				<StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
					<Button Content="Exporter PDF" 
							Command="{Binding ExportPdfCommand}" 
							Style="{StaticResource MaterialDesignOutlinedButton}" 
							Margin="0,0,10,0">
						<Button.ContentTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<materialDesign:PackIcon Kind="FilePdfBox" Margin="0,0,8,0" VerticalAlignment="Center"/>
									<TextBlock Text="Exporter PDF"/>
								</StackPanel>
							</DataTemplate>
						</Button.ContentTemplate>
					</Button>
					<Button Content="Enregistrer" Command="{Binding SaveCommand}" Style="{StaticResource MaterialDesignRaisedButton}" Margin="0,0,10,0"/>
					<Button Content="Annuler" Command="{Binding CancelCommand}" Style="{StaticResource MaterialDesignOutlinedButton}"/>
				</StackPanel>
			</Grid>
		</materialDesign:Card>

        <!-- Contenu -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="10">
                <!-- Informations générales et dates -->
                <materialDesign:Card Padding="20" Margin="0,0,0,10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock Text="Informations du Dossier" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,15"/>
                            <TextBox Text="{Binding Conteneur.NumeroDossier, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Numéro du conteneur *" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,10"/>
                            <TextBox Text="{Binding Conteneur.NumeroPlomb, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Numéro du plomb" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,10"/>
                            <TextBox Text="{Binding Conteneur.NomCompagnie, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Nom de la compagnie" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,10"/>
                            <TextBox Text="{Binding Conteneur.Destination, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Destination (Ville/Port) *" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,10"/>
                            <TextBox Text="{Binding Conteneur.PaysDestination, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Pays de Destination *" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,10"/>
                            <TextBox Text="{Binding Conteneur.NomTransitaire, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Nom du transitaire" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,10"/>
                            <TextBox Text="{Binding Conteneur.Commentaires, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Commentaires" Style="{StaticResource MaterialDesignOutlinedTextBox}" TextWrapping="Wrap" Height="80"/>
                        </StackPanel>
                        <StackPanel Grid.Column="1" Margin="10,0,0,0">
                            <TextBlock Text="Dates Clés" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,15"/>
                            <DatePicker SelectedDate="{Binding Conteneur.DateReception, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Date de réception *" Style="{StaticResource MaterialDesignOutlinedDatePicker}" Margin="0,0,0,10"/>
                            <DatePicker SelectedDate="{Binding Conteneur.DateChargement, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Date de chargement" Style="{StaticResource MaterialDesignOutlinedDatePicker}" Margin="0,0,0,10"/>
                            <DatePicker SelectedDate="{Binding Conteneur.DateDepart, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Date de départ" Style="{StaticResource MaterialDesignOutlinedDatePicker}" Margin="0,0,0,10"/>
                            <DatePicker SelectedDate="{Binding Conteneur.DateArriveeDestination, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Date d'arrivée à destination" Style="{StaticResource MaterialDesignOutlinedDatePicker}" Margin="0,0,0,10"/>
                            <DatePicker SelectedDate="{Binding Conteneur.DateDedouanement, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Date de dédouanement" Style="{StaticResource MaterialDesignOutlinedDatePicker}" Margin="0,0,0,10"/>
							<DatePicker SelectedDate="{Binding Conteneur.DateCloture, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Date de clôture" Style="{StaticResource MaterialDesignOutlinedDatePicker}" Margin="0,0,0,10"/>
                        </StackPanel>
                    </Grid>
                </materialDesign:Card>

                <!-- Clients concernés -->
                <materialDesign:Card Padding="20" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="Clients Concernés" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,10"/>
						<DataGrid ItemsSource="{Binding ClientsAffiches}" AutoGenerateColumns="False" IsReadOnly="True" MaxHeight="200">
							<DataGrid.Resources>
								<Style TargetType="DataGridRow">
									<Setter Property="Tag" Value="{Binding DataContext, RelativeSource={RelativeSource AncestorType=UserControl}}"/>
									<Setter Property="ContextMenu">
										<Setter.Value>
											<ContextMenu>
												<MenuItem Header="Voir détails du client..."
														  Command="{Binding PlacementTarget.Tag.ViewClientDetailsInWindowCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
														  CommandParameter="{Binding Client.Id}"/> <!-- MODIFIÉ : On pointe vers Client.Id -->
											</ContextMenu>
										</Setter.Value>
									</Setter>
								</Style>
							</DataGrid.Resources>
							<DataGrid.Columns>
								<DataGridTextColumn Header="Code" Binding="{Binding Client.CodeClient}" Width="Auto"/>
								<DataGridTextColumn Header="Client" Binding="{Binding Client.NomComplet}" Width="*"/>
								<DataGridTextColumn Header="Téléphone" Binding="{Binding Client.TelephonePrincipal}" Width="*"/>
								
								<!-- NOUVELLES COLONNES FINANCIÈRES -->
								<DataGridTemplateColumn Header="Prix Total" Width="*">
									<DataGridTemplateColumn.CellTemplate>
										<DataTemplate>
											<TextBlock Text="{Binding PrixTotalConteneur, StringFormat=C}" FontWeight="Bold" Foreground="{DynamicResource PrimaryHueMidBrush}"/>
										</DataTemplate>
									</DataGridTemplateColumn.CellTemplate>
								</DataGridTemplateColumn>

								<DataGridTemplateColumn Header="Total Payé" Width="*">
									<DataGridTemplateColumn.CellTemplate>
										<DataTemplate>
											<TextBlock Text="{Binding TotalPayeConteneur, StringFormat=C}" FontWeight="Bold" Foreground="{DynamicResource SuccessBrush}"/>
										</DataTemplate>
									</DataGridTemplateColumn.CellTemplate>
								</DataGridTemplateColumn>

								<DataGridTemplateColumn Header="Total Restant" Width="*">
									<DataGridTemplateColumn.CellTemplate>
										<DataTemplate>
											<TextBlock Text="{Binding TotalRestantConteneur, StringFormat=C}" FontWeight="Bold" Foreground="{DynamicResource ErrorBrush}"/>
										</DataTemplate>
									</DataGridTemplateColumn.CellTemplate>
								</DataGridTemplateColumn>
								
							</DataGrid.Columns>
						</DataGrid>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Section Colis -->
                <materialDesign:Card Padding="20" Margin="0,0,0,10">
                    <Expander Header="Gestion des Colis">
                        <StackPanel>
							<!-- NOUVEAU CODE À INSERER -->
							<Button Style="{StaticResource MaterialDesignRaisedButton}" 
									Command="{Binding OpenAddColisWindowCommand}" 
									Margin="0,10,0,10"
									HorizontalAlignment="Left">
								<StackPanel Orientation="Horizontal">
									<materialDesign:PackIcon Kind="PackageVariantPlus" Margin="0,0,8,0"/>
									<TextBlock Text="Ajouter des Colis..."/>
								</StackPanel>
							</Button>
							<TextBlock Text="Colis Affectés" Style="{StaticResource MaterialDesignSubtitle1TextBlock}" Margin="0,10,0,5"/>
							<DataGrid ItemsSource="{Binding ColisAffectes}" AutoGenerateColumns="False" IsReadOnly="True" MaxHeight="300">
								<DataGrid.Resources>
									<Style TargetType="DataGridRow">
										<!-- On stocke le ViewModel principal dans le Tag pour que le ContextMenu le trouve -->
										<Setter Property="Tag" Value="{Binding DataContext, RelativeSource={RelativeSource AncestorType=UserControl}}"/>
										<Setter Property="ContextMenu">
											<Setter.Value>
												<ContextMenu>
													<MenuItem Header="Ouvrir l'inventaire" 
															  Command="{Binding PlacementTarget.Tag.OpenInventaireCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}" 
															  CommandParameter="{Binding}">
														<MenuItem.Icon><materialDesign:PackIcon Kind="ClipboardList" /></MenuItem.Icon>
													</MenuItem>
													<MenuItem Header="Modifier le colis..." 
															  Command="{Binding PlacementTarget.Tag.EditColisInWindowCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}" 
															  CommandParameter="{Binding}">
														<MenuItem.Icon><materialDesign:PackIcon Kind="Pencil" /></MenuItem.Icon>
													</MenuItem>
													<MenuItem Header="Gérer les Paiements" Command="{Binding PlacementTarget.Tag.OpenColisPaiementsCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}" CommandParameter="{Binding}">
														<MenuItem.Icon><materialDesign:PackIcon Kind="CreditCard" /></MenuItem.Icon>
													</MenuItem>
													<Separator />
													<MenuItem Header="Voir détails du client..."
															  Command="{Binding PlacementTarget.Tag.ViewClientDetailsInWindowCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
															  CommandParameter="{Binding Client.Id}">
														<MenuItem.Icon><materialDesign:PackIcon Kind="AccountEye" /></MenuItem.Icon>
													</MenuItem>
												</ContextMenu>
											</Setter.Value>
										</Setter>
									</Style>
								</DataGrid.Resources>
								<DataGrid.Columns>
									<DataGridTextColumn Header="Référence" Binding="{Binding NumeroReference}" Width="*" FontWeight="Bold"/>
									<DataGridTextColumn Header="Client" Binding="{Binding Client.NomComplet}" Width="*"/>
									<DataGridTextColumn Header="Désignation" Binding="{Binding Designation}" Width="2*"/>
									
									<!-- COLONNE DESTINATION AJOUTÉE -->
									<DataGridTextColumn Header="Destination" Binding="{Binding DestinationFinale}" Width="*"/>
									
									<DataGridTextColumn Header="Pièces" Binding="{Binding NombrePieces}" Width="Auto"/>
									
									<!-- COLONNES FINANCIÈRES AJOUTÉES AVEC LES COULEURS -->
									<DataGridTextColumn Header="Prix Total" Binding="{Binding PrixTotal, StringFormat=C}" Width="*">
										<DataGridTextColumn.ElementStyle>
											<Style TargetType="TextBlock"><Setter Property="FontWeight" Value="Bold"/><Setter Property="Foreground" Value="{DynamicResource PrimaryHueMidBrush}"/></Style>
										</DataGridTextColumn.ElementStyle>
									</DataGridTextColumn>

									<DataGridTextColumn Header="Total Payé" Binding="{Binding SommePayee, StringFormat=C}" Width="*">
										<DataGridTextColumn.ElementStyle>
											<Style TargetType="TextBlock"><Setter Property="FontWeight" Value="Bold"/><Setter Property="Foreground" Value="{StaticResource SuccessBrush}"/></Style>
										</DataGridTextColumn.ElementStyle>
									</DataGridTextColumn>

									<DataGridTextColumn Header="Total Restant" Binding="{Binding RestantAPayer, StringFormat=C}" Width="*">
										<DataGridTextColumn.ElementStyle>
											<Style TargetType="TextBlock"><Setter Property="FontWeight" Value="Bold"/><Setter Property="Foreground" Value="{StaticResource ErrorBrush}"/></Style>
										</DataGridTextColumn.ElementStyle>
									</DataGridTextColumn>

									<DataGridTemplateColumn>
										<DataGridTemplateColumn.CellTemplate>
											<DataTemplate>
												<Button Command="{Binding DataContext.RemoveColisCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" CommandParameter="{Binding}" ToolTip="Retirer du conteneur">
													<materialDesign:PackIcon Kind="Delete" Foreground="Red"/>
												</Button>
											</DataTemplate>
										</DataGridTemplateColumn.CellTemplate>
									</DataGridTemplateColumn>
								</DataGrid.Columns>
																								
							</DataGrid>
							
							<!-- NOUVELLE SECTION : STATS COLIS -->
							<materialDesign:Card Margin="0,5,0,0" Padding="8">
								<WrapPanel HorizontalAlignment="Right">
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="Package" VerticalAlignment="Center" Margin="0,0,5,0"/>
										<TextBlock Text="Total : "/>
										<TextBlock Text="{Binding TotalColisAffectes}" FontWeight="Bold"/>
										<TextBlock Text=" colis"/>
									</StackPanel>
									<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="Numeric" VerticalAlignment="Center" Margin="0,0,5,0"/>
										<TextBlock Text="Pièces : "/>
										<TextBlock Text="{Binding TotalPiecesColis}" FontWeight="Bold"/>
									</StackPanel>
									<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="15,0"/>
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="CashMultiple" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{DynamicResource PrimaryHueMidBrush}"/>
										<TextBlock Text="{Binding PrixTotalColis, StringFormat=C}"/>
									</StackPanel>
									<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="CashCheck" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{StaticResource SuccessBrush}"/>
										<TextBlock Text="{Binding TotalPayeColis, StringFormat=C}"/>
									</StackPanel>
									<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="CashRemove" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{StaticResource ErrorBrush}"/>
										<TextBlock Text="{Binding TotalRestantColis, StringFormat=C}"/>
									</StackPanel>
								</WrapPanel>
							</materialDesign:Card>
							
                        </StackPanel>
                    </Expander>
                </materialDesign:Card>

                <!-- Section Vehicules -->
                <materialDesign:Card Padding="20">
                    <Expander Header="Gestion des Véhicules">
                        <StackPanel>
                            <!-- Recherche de véhicules -->
							<Button Style="{StaticResource MaterialDesignRaisedButton}" 
									Command="{Binding OpenAddVehiculeWindowCommand}" 
									Margin="0,10,0,10"
									HorizontalAlignment="Left">
								<StackPanel Orientation="Horizontal">
									<materialDesign:PackIcon Kind="Car" Margin="0,0,8,0"/>
									<TextBlock Text="Ajouter des Véhicules..."/>
								</StackPanel>
							</Button>

                            <!-- Véhicules affectés -->
							<TextBlock Text="Véhicules Affectés" Style="{StaticResource MaterialDesignSubtitle1TextBlock}" Margin="0,10,0,5"/>
							<DataGrid ItemsSource="{Binding VehiculesAffectes}" AutoGenerateColumns="False" IsReadOnly="True" MaxHeight="300">
								
								<!-- SECTION À AJOUTER -->
								<DataGrid.Resources>
									<Style TargetType="DataGridRow">
										<!-- On stocke le ViewModel principal dans le Tag pour que le ContextMenu le trouve -->
										<Setter Property="Tag" Value="{Binding DataContext, RelativeSource={RelativeSource AncestorType=UserControl}}"/>
										<Setter Property="ContextMenu">
											<Setter.Value>
												<ContextMenu>
													<MenuItem Header="Modifier le véhicule..."
															  Command="{Binding PlacementTarget.Tag.EditVehiculeInWindowCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
															  CommandParameter="{Binding}">
														<MenuItem.Icon><materialDesign:PackIcon Kind="Pencil" /></MenuItem.Icon>
													</MenuItem>
													<MenuItem Header="Gérer les Paiements" Command="{Binding PlacementTarget.Tag.OpenVehiculePaiementsCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}" CommandParameter="{Binding}">
														<MenuItem.Icon><materialDesign:PackIcon Kind="CreditCard" /></MenuItem.Icon>
													</MenuItem>
													<Separator />
													<MenuItem Header="Voir détails du client..."
															  Command="{Binding PlacementTarget.Tag.ViewClientDetailsInWindowCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
															  CommandParameter="{Binding Client.Id}">
														<MenuItem.Icon><materialDesign:PackIcon Kind="AccountEye" /></MenuItem.Icon>
													</MenuItem>
												</ContextMenu>
											</Setter.Value>
										</Setter>
									</Style>
								</DataGrid.Resources>
								<DataGrid.Columns>
									<DataGridTextColumn Header="Immatriculation" Binding="{Binding Immatriculation}" Width="*" FontWeight="Bold"/>
									<DataGridTextColumn Header="Client" Binding="{Binding Client.NomComplet}" Width="1.5*"/>
									<DataGridTextColumn Header="Marque &amp; Modèle" Width="1.5*">
										<DataGridTextColumn.Binding>
											<MultiBinding StringFormat="{}{0} {1}">
												<Binding Path="Marque"/>
												<Binding Path="Modele"/>
											</MultiBinding>
										</DataGridTextColumn.Binding>
									</DataGridTextColumn>
									<DataGridTextColumn Header="Année" Binding="{Binding Annee}" Width="Auto"/>
                                    <DataGridTemplateColumn Header="Commentaires" Width="2*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Commentaires, Converter={StaticResource ToUpperConverter}}"
                                                           Foreground="{StaticResource ErrorBrush}"
                                                           FontWeight="Bold"
                                                           TextWrapping="Wrap"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

									<!-- COLONNES FINANCIÈRES CORRIGÉES -->
									<DataGridTemplateColumn Header="Prix Total" Width="*">
										<DataGridTemplateColumn.CellTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding PrixTotal, StringFormat=C}" FontWeight="Bold" Foreground="{DynamicResource PrimaryHueMidBrush}"/>
											</DataTemplate>
										</DataGridTemplateColumn.CellTemplate>
									</DataGridTemplateColumn>
									<DataGridTemplateColumn Header="Payé" Width="*">
										<DataGridTemplateColumn.CellTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding SommePayee, StringFormat=C}" FontWeight="Bold" Foreground="{DynamicResource SuccessBrush}"/>
											</DataTemplate>
										</DataGridTemplateColumn.CellTemplate>
									</DataGridTemplateColumn>
									<DataGridTemplateColumn Header="Restant" Width="*">
										<DataGridTemplateColumn.CellTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding RestantAPayer, StringFormat=C}" FontWeight="Bold" Foreground="{DynamicResource ErrorBrush}"/>
											</DataTemplate>
										</DataGridTemplateColumn.CellTemplate>
									</DataGridTemplateColumn>
									
									<DataGridTemplateColumn>
										<DataGridTemplateColumn.CellTemplate>
											<DataTemplate>
												<Button Command="{Binding DataContext.RemoveVehiculeCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" CommandParameter="{Binding}" ToolTip="Retirer du conteneur">
													<materialDesign:PackIcon Kind="Delete" Foreground="Red"/>
												</Button>
											</DataTemplate>
										</DataGridTemplateColumn.CellTemplate>
									</DataGridTemplateColumn>
								</DataGrid.Columns>															
								
                            </DataGrid>
							
							<!-- NOUVELLE SECTION : STATS VÉHICULES -->
							<materialDesign:Card Margin="0,5,0,0" Padding="8">
								<WrapPanel HorizontalAlignment="Right">
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="CarMultiple" VerticalAlignment="Center" Margin="0,0,5,0"/>
										<TextBlock Text="Total : "/>
										<TextBlock Text="{Binding TotalVehiculesAffectes}" FontWeight="Bold"/>
										<TextBlock Text=" véhicules"/>
									</StackPanel>
									<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="15,0"/>
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="CashMultiple" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{DynamicResource PrimaryHueMidBrush}"/>
										<TextBlock Text="{Binding PrixTotalVehicules, StringFormat=C}"/>
									</StackPanel>
									<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="CashCheck" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{StaticResource SuccessBrush}"/>
										<TextBlock Text="{Binding TotalPayeVehicules, StringFormat=C}"/>
									</StackPanel>
									<Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
									<StackPanel Orientation="Horizontal" Margin="8,0">
										<materialDesign:PackIcon Kind="CashRemove" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{StaticResource ErrorBrush}"/>
										<TextBlock Text="{Binding TotalRestantVehicules, StringFormat=C}"/>
									</StackPanel>
								</WrapPanel>
							</materialDesign:Card>								
							
                        </StackPanel>
                    </Expander>
                </materialDesign:Card>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>